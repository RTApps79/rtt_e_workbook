<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Identification & Safety Protocols</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Feedback styles consistent with other updated lessons */
        .selected-option { background-color: #e0f2fe; /* Tailwind sky-100 */ border-color: #38bdf8; /* Tailwind sky-400 */ }
        .correct-answer-feedback { background-color: #dcfce7 !important; /* Tailwind green-100 */ border-left: 4px solid #22c55e !important; /* Tailwind green-500 */ }
        .incorrect-answer-feedback { background-color: #fee2e2 !important; /* Tailwind red-100 */ border-left: 4px solid #ef4444 !important; /* Tailwind red-500 */ }
        .correct-indicator::after { content: '✔ Correct'; color: #16a34a; /* Tailwind green-600 */ font-weight: bold; margin-left: 10px; }
        .incorrect-indicator::after { content: '✖ Incorrect'; color: #dc2626; /* Tailwind red-600 */ font-weight: bold; margin-left: 10px; }
        .correct-option-text { font-weight: bold; color: #15803d; /* Tailwind green-700 */ }

        .highlight { /* Tailwind purple theme for highlight */
            background-color: #ede9fe; /* purple-100 */
            color: #5b21b6; /* purple-700 */
            padding: 0.1em 0.3em;
            border-radius: 0.25rem;
            font-weight: 500;
        }
        .note { /* Tailwind slate theme for note */
            font-size: 0.9em; font-style: italic; color: #4b5563; /* slate-600 */
            background-color: #f3f4f6; /* slate-100 */
            padding: 10px; border-left: 3px solid #6b7280; /* slate-500 */
            margin: 15px 0; border-radius: 4px;
        }
        .activity-link-button { /* Green button for activities */
            display: inline-block; background-color: #22c55e; /* green-500 */
            color: white; padding: 12px 25px; text-align: center;
            text-decoration: none; border-radius: 0.375rem; /* rounded-lg */
            font-size: 1.1em; font-weight: 500; /* medium */
            margin-top: 15px; transition: background-color 0.2s;
        }
        .activity-link-button:hover { background-color: #16a34a; /* green-600 */ }

        /* Print Styles */
        @media print {
            body { background-color: #fff; margin: 10px; padding: 0; font-size: 10pt; }
            .main-content-wrapper, .flip-lesson-container { box-shadow: none !important; border: none !important; width: 100%; max-width: 100%; padding: 5px; margin-bottom: 15px;}
            .lesson-navigation-bar, .check-page-answers-button, .nav-links-header, .print-button-container, .activity-link-button { display: none !important; }
            .lesson-page { page-break-inside: avoid; border: 1px solid #eee !important; }
            .interactive-question-block {background: #fff !important; border: 1px solid #ccc !important; }
            h1, h2, h3, h4 { color: #000 !important; border-color: #000 !important; margin-bottom: 10px; padding-bottom: 3px;}
            .explanation-text { display: none !important; } 
            a {text-decoration: none; color: #000 !important;}
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex flex-col min-h-screen">

    <header class="bg-white shadow-md sticky top-0 z-50 nav-links-header">
        <div class="container mx-auto px-6 py-3 flex flex-col sm:flex-row justify-between items-center">
            <h1 class="text-xl font-bold text-purple-700 mb-2 sm:mb-0">Patient ID & Safety Protocols</h1>
            <div class="flex flex-wrap justify-center sm:justify-end space-x-2">
                <a href="index.html" class="text-xs sm:text-sm bg-purple-500 text-white font-medium py-2 px-3 rounded-lg hover:bg-purple-600 transition-colors duration-300 mb-1 sm:mb-0">
                    &larr; Back to Patient Care Menu
                </a>
                <a href="../index.html" class="text-xs sm:text-sm bg-slate-500 text-white font-medium py-2 px-3 rounded-lg hover:bg-slate-600 transition-colors duration-300 mb-1 sm:mb-0">
                    &larr; Back to Main Workbook
                </a>
            </div>
        </div>
    </header>

    <main class="container mx-auto max-w-4xl px-4 sm:px-6 py-8 flex-grow main-content-wrapper">
        <div class="bg-white p-6 sm:p-8 rounded-xl shadow-xl">
            <h1 class="text-3xl font-bold text-purple-700 mb-6 text-center border-b-2 border-purple-300 pb-4">Safety First: Patient Identification & Verification Protocols</h1>

            <div class="flip-lesson-container bg-purple-50 p-4 sm:p-6 rounded-lg shadow-md mb-8 border border-purple-200">
                <h2 class="text-2xl font-semibold text-purple-600 mb-4">Interactive Lesson</h2>

                <div id="lesson-page-1" class="lesson-page active bg-white p-4 sm:p-5 rounded-md border border-purple-200 min-h-[480px]">
                    <h3 class="text-xl font-semibold text-purple-700 mb-3">Page 1: The RTT's Prime Directive - Patient Safety</h3>
                    <div class="mb-4 p-3 bg-purple-100 rounded-md border border-purple-200">
                        <h4 class="text-lg font-medium text-purple-600 mb-1">Purpose: Why This Matters</h4>
                        <p class="text-sm text-slate-600">This lesson instills a thorough understanding of critical patient identification protocols, treatment site verification procedures, and overarching safety measures essential in the radiation therapy environment to prevent errors and ensure patient well-being.</p>
                    </div>
                    <div class="mb-4 p-3 bg-purple-100 rounded-md border border-purple-200">
                        <h4 class="text-lg font-medium text-purple-600 mb-1">Task: What You Will Do</h4>
                        <p class="text-sm text-slate-600">Learn about standardized identification methods, techniques for site verification, common safety checks, and the RTT's vital role in maintaining a safe treatment environment.</p>
                    </div>
                    <div class="p-3 bg-purple-100 rounded-md border border-purple-200">
                        <h4 class="text-lg font-medium text-purple-600 mb-1">Criteria for Success</h4>
                        <p class="text-sm text-slate-600">Understand and be able to describe multi-step patient ID processes, methods for treatment site verification, and key daily safety protocols.</p>
                    </div>
                    <p class="mt-4 text-slate-700">Patient safety is <span class="highlight">paramount</span> in radiation therapy. National Patient Safety Goals (NPSGs), such as those established by The Joint Commission, emphasize key areas like "Identify patients correctly" and "Improve staff communication," which are directly relevant to our daily practice. As an RTT, you are a crucial guardian of patient safety.</p>
                </div>

                <div id="lesson-page-2" class="lesson-page bg-white p-4 sm:p-5 rounded-md border border-purple-200 min-h-[480px]">
                    <h3 class="text-xl font-semibold text-purple-700 mb-3">Page 2: Correct Patient Identification - The "Two Identifier" Rule & Beyond</h3>
                    <p class="text-slate-700">Accurate patient identification is the first and one of the most critical steps to prevent wrong-patient medical errors.</p>
                    <h4 class="text-lg font-medium text-purple-600 my-2">Standard Protocol: Using At Least Two Identifiers</h4>
                    <p class="text-sm text-slate-700">Always use <span class="highlight">at least two unique patient identifiers</span> before initiating any procedure or treatment. Examples include:</p>
                    <ul class="list-disc list-inside text-slate-600 space-y-1 text-xs ml-4">
                        <li>Patient's full name</li>
                        <li>Date of birth (DOB)</li>
                        <li>Medical Record Number (MRN) or other assigned unique ID number</li>
                        <li>Patient photograph (cross-referenced with other identifiers)</li>
                    </ul>
                    <h4 class="text-lg font-medium text-purple-600 my-2">Active Patient Involvement:</h4>
                    <p class="text-sm text-slate-700">Actively involve the patient in the identification process. Ask them to <span class="highlight">state their full name and date of birth</span>. Avoid leading questions such as, "Are you John Smith?" or "Is your birthday January 1st?"</p>
                    <h4 class="text-lg font-medium text-purple-600 my-2">Verification Sources:</h4>
                    <p class="text-sm text-slate-700">Cross-reference the patient's stated identifiers with information on the treatment chart, Electronic Medical Record (EMR), consent forms, and any physical identifiers (e.g., inpatient wristband).</p>
                    <p class="note text-sm">Unacceptable identifiers for primary confirmation include the patient's room number or a verbal confirmation from another staff member who hasn't just actively verified the patient themselves.</p>
                    <div class="interactive-question-block mt-6 bg-purple-50 p-3 rounded-md border border-purple-200" id="q_page2_1">
                        <p class="question-text font-semibold text-slate-700 mb-2">Quick Check: Which is the BEST method to confirm a patient's identity before starting a procedure?</p>
                        <label class="block mb-1 p-2 rounded hover:bg-purple-100 cursor-pointer"><input type="radio" name="q_page2_1_ans" value="A" class="mr-2 accent-purple-600"> Checking the name on the door of the waiting room cubicle.</label>
                        <label class="block mb-1 p-2 rounded hover:bg-purple-100 cursor-pointer"><input type="radio" name="q_page2_1_ans" value="B" class="mr-2 accent-purple-600"> Asking the patient to state their full name and date of birth, then matching it to the chart.</label>
                        <label class="block mb-1 p-2 rounded hover:bg-purple-100 cursor-pointer"><input type="radio" name="q_page2_1_ans" value="C" class="mr-2 accent-purple-600"> Asking "Are you Mrs. Johnson?"</label>
                        <div class="explanation-text text-sm text-slate-600 mt-2 p-2 bg-purple-50 rounded" style="display:none;">Correct! B. Actively having the patient state their full name and DOB, then verifying against official records, is a robust two-identifier method.</div>
                    </div>
                    <button class="check-page-answers-button mt-3 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors text-sm" onclick="checkPageAnswer('q_page2_1', 'B')">Check Answer</button>
                </div>
                
                <div id="lesson-page-3" class="lesson-page bg-white p-4 sm:p-5 rounded-md border border-purple-200 min-h-[480px]">
                    <h3 class="text-xl font-semibold text-purple-700 mb-3">Page 3: Treatment Site & Laterality Verification</h3>
                    <p class="text-slate-700">Verifying the correct treatment site, including side (laterality, e.g., left vs. right), is essential before every fraction.</p>
                    <h4 class="text-lg font-medium text-purple-600 my-2">Multi-Point Verification Sources:</h4>
                     <ul class="list-disc list-inside text-slate-700 space-y-1 text-sm mb-4">
                        <li>Radiation Oncologist’s signed prescription and detailed treatment plan.</li>
                        <li>Simulation images, setup instructions, diagrams, and photographs.</li>
                        <li>Patient’s skin markings/tattoos and their relation to the planned isocenter.</li>
                        <li>Immobilization devices and their indexed setup positions.</li>
                        <li>Treatment console parameters matching the approved plan for the correct site and laterality.</li>
                    </ul>
                    <h4 class="text-lg font-medium text-purple-600 my-2">The "Time Out" Procedure:</h4>
                    <p class="text-sm text-slate-700">A mandatory, active pause taken by the treatment team (typically two RTTs) <span class="highlight">immediately before initiating the beam</span>. During the Time Out, the team verbally confirms:</p>
                    <ul class="list-disc list-inside text-slate-600 space-y-1 text-xs ml-4">
                        <li>Correct patient (using two identifiers).</li>
                        <li>Correct treatment site and laterality (e.g., "Left Breast").</li>
                        <li>Correct treatment plan loaded and parameters (e.g., gantry, collimator, couch angles, MUs) matched.</li>
                        <li>Correct accessories (bolus, wedges, etc.) and their orientation, if applicable.</li>
                        <li>Agreement between all team members present.</li>
                    </ul>
                    <p class="text-sm text-slate-700 mt-2"><span class="highlight">When in doubt, STOP and verify.</span> Any mismatch or uncertainty must be resolved before proceeding, involving dosimetry, physics, or the oncologist if necessary.</p>
                    <div class="interactive-question-block mt-6 bg-purple-50 p-3 rounded-md border border-purple-200" id="q_page3_1">
                        <p class="question-text font-semibold text-slate-700 mb-2">Quick Check: A "Time Out" procedure is performed:</p>
                        <label class="block mb-1 p-2 rounded hover:bg-purple-100 cursor-pointer"><input type="radio" name="q_page3_1_ans" value="A" class="mr-2 accent-purple-600"> Only for the first treatment fraction.</label>
                        <label class="block mb-1 p-2 rounded hover:bg-purple-100 cursor-pointer"><input type="radio" name="q_page3_1_ans" value="B" class="mr-2 accent-purple-600"> After the treatment is completed to document settings.</label>
                        <label class="block mb-1 p-2 rounded hover:bg-purple-100 cursor-pointer"><input type="radio" name="q_page3_1_ans" value="C" class="mr-2 accent-purple-600"> Immediately before initiating the beam for each treatment.</label>
                        <div class="explanation-text text-sm text-slate-600 mt-2 p-2 bg-purple-50 rounded" style="display:none;">Correct! C. The Time Out is a crucial final verification step done just before each treatment delivery.</div>
                    </div>
                    <button class="check-page-answers-button mt-3 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors text-sm" onclick="checkPageAnswer('q_page3_1', 'C')">Check Answer</button>
                </div>

                <div id="lesson-page-4" class="lesson-page bg-white p-4 sm:p-5 rounded-md border border-purple-200 min-h-[480px]">
                    <h3 class="text-xl font-semibold text-purple-700 mb-3">Page 4: Daily Safety Checks & Creating a Safe Environment</h3>
                    <p class="text-slate-700">RTTs are responsible for ensuring the safety of the equipment and the treatment environment daily.</p>
                    <h4 class="text-lg font-medium text-purple-600 my-2">Linac & Equipment Safety:</h4>
                    <ul class="list-disc list-inside text-slate-700 space-y-1 text-sm mb-4">
                        <li>Perform daily machine warm-up and Quality Assurance (QA) checks per institutional protocol. This often includes checking:
                            <ul class="list-disc list-inside text-slate-600 space-y-1 text-xs ml-6">
                                <li>Safety interlocks (e.g., door, beam-on indicators).</li>
                                <li>Audio and visual patient monitoring systems.</li>
                                <li>Emergency stop buttons functionality.</li>
                                <li>Laser alignment and ODI/rangefinder accuracy.</li>
                            </ul>
                        </li>
                        <li>Report any equipment malfunctions or QA deviations immediately to medical physics or engineering.</li>
                    </ul>
                    <h4 class="text-lg font-medium text-purple-600 my-2">Treatment Room Environment & Patient Safety:</h4>
                    <ul class="list-disc list-inside text-slate-700 space-y-1 text-sm">
                        <li>Ensure the room is clear of obstacles and unnecessary items.</li>
                        <li>Verify correct treatment accessories (wedges, electron cones, bolus) are selected, in good condition, and correctly oriented.</li>
                        <li>Confirm patient monitoring systems are functional.</li>
                        <li>Ensure the patient is secure and as comfortable as possible in immobilization devices.</li>
                        <li>Provide clear instructions to the patient to remain still and how to communicate if needed.</li>
                        <li>Maintain continuous audio and visual contact during beam-on.</li>
                    </ul>
                </div>

                <div id="lesson-page-5" class="lesson-page bg-white p-4 sm:p-5 rounded-md border border-purple-200 min-h-[480px]">
                    <h3 class="text-xl font-semibold text-purple-700 mb-3">Page 5: Responding to Emergencies & Unexpected Events</h3>
                    <p class="text-slate-700">Being prepared for the unexpected is crucial.</p>
                    <h4 class="text-lg font-medium text-purple-600 my-2">Medical Emergencies:</h4>
                     <ul class="list-disc list-inside text-slate-700 space-y-1 text-sm mb-4">
                        <li>Recognize signs of patient distress (difficulty breathing, chest pain, altered mental status, seizure, etc.).</li>
                        <li>Know how to activate your facility's emergency response system (e.g., "Code Blue," rapid response).</li>
                        <li>Be prepared to initiate Basic Life Support (BLS) as per your training.</li>
                    </ul>
                    <h4 class="text-lg font-medium text-purple-600 my-2">Equipment Malfunctions:</h4>
                    <ul class="list-disc list-inside text-slate-700 space-y-1 text-sm mb-4">
                        <li>Know the location and operation of all emergency stop buttons on the Linac and couch.</li>
                        <li>Understand procedures for safely assisting the patient off the couch if the machine stops unexpectedly.</li>
                        <li>Report all malfunctions immediately according to facility protocol.</li>
                    </ul>
                    <h4 class="text-lg font-medium text-purple-600 my-2">Other Emergencies & Incident Reporting:</h4>
                    <ul class="list-disc list-inside text-slate-700 space-y-1 text-sm">
                        <li>Be familiar with fire safety procedures (RACE: Rescue, Alarm, Contain, Extinguish/Evacuate).</li>
                        <li>Understand your facility's specific codes for other emergencies.</li>
                        <li><span class="highlight">Incident Reporting:</span> Report all incidents, errors (even those that don't reach the patient), and "near misses." This is vital for a culture of safety and continuous quality improvement.</li>
                    </ul>
                    <div class="interactive-question-block mt-6 bg-purple-50 p-3 rounded-md border border-purple-200" id="q_page5_1">
                        <p class="question-text font-semibold text-slate-700 mb-2">Quick Check: If you make an error that does NOT reach the patient (a "near miss"), should you still report it?</p>
                        <label class="block mb-1 p-2 rounded hover:bg-purple-100 cursor-pointer"><input type="radio" name="q_page5_1_ans" value="A" class="mr-2 accent-purple-600"> No, because no harm was done.</label>
                        <label class="block mb-1 p-2 rounded hover:bg-purple-100 cursor-pointer"><input type="radio" name="q_page5_1_ans" value="B" class="mr-2 accent-purple-600"> Yes, to help prevent future errors and improve systems.</label>
                        <label class="block mb-1 p-2 rounded hover:bg-purple-100 cursor-pointer"><input type="radio" name="q_page5_1_ans" value="C" class="mr-2 accent-purple-600"> Only if your supervisor sees it happen.</label>
                        <div class="explanation-text text-sm text-slate-600 mt-2 p-2 bg-purple-50 rounded" style="display:none;">Correct! B. Reporting near misses is crucial for identifying system weaknesses and preventing future actual errors.</div>
                    </div>
                    <button class="check-page-answers-button mt-3 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors text-sm" onclick="checkPageAnswer('q_page5_1', 'B')">Check Answer</button>
                </div>
                
                <div id="lesson-page-6" class="lesson-page bg-white p-4 sm:p-5 rounded-md border border-purple-200 min-h-[480px]">
                    <h3 class="text-xl font-semibold text-purple-700 mb-3">Page 6: Summary & Activity Link</h3>
                    <p class="text-slate-700">Patient safety is the absolute priority in radiation therapy. This lesson highlighted:</p>
                    <ul class="list-disc list-inside text-slate-700 space-y-1 text-sm mb-4">
                        <li>The non-negotiable importance of <span class="highlight">accurate patient identification</span> using at least two active identifiers.</li>
                        <li>Critical need for meticulous <span class="highlight">treatment site and laterality verification</span> at multiple checkpoints.</li>
                        <li>The vital role of the <span class="highlight">"Time Out" procedure</span> before every beam-on.</li>
                        <li>Consistent performance of <span class="highlight">daily equipment safety checks</span> and maintaining a safe environment.</li>
                        <li>Preparedness for <span class="highlight">emergencies</span> and the importance of transparent <span class="highlight">incident reporting</span>.</li>
                    </ul>
                    <p class="text-slate-700">As an RTT, you are a key defender of patient safety. Your diligence, attention to detail, and adherence to these protocols protect your patients and uphold the highest standards of care.</p>
                    <h4 class="text-lg font-medium text-purple-600 mt-6 mb-2">Test Your Safety Knowledge:</h4>
                    <p class="text-slate-700">Proceed to the "Patient Safety & ID Verification Lab" to apply these concepts in simulated scenarios.</p>
                    <div class="mt-6 text-center">
                        <a href="patient_safety_id_lab.html" class="activity-link-button">
                            Go to Patient Safety & ID Lab
                        </a>
                    </div>
                </div>

                <div class="lesson-navigation-bar text-center mt-6">
                    <button id="prevLessonPage" onclick="changeLessonPage(-1)" disabled class="bg-purple-500 text-white py-2 px-4 rounded-lg hover:bg-purple-600 transition-colors disabled:bg-slate-300 text-sm">Previous Page</button>
                    <button id="backToMenuButton" onclick="goBackToPatientCareMenu()" style="display:none;" class="bg-slate-500 text-white py-2 px-4 rounded-lg hover:bg-slate-600 transition-colors text-sm">Back to Patient Care Menu</button>
                    <span class="page-indicator mx-2 sm:mx-4 text-sm text-slate-600" id="lessonPageIndicator">Page 1 of 6</span>
                    <button id="nextLessonPage" onclick="changeLessonPage(1)" class="bg-purple-500 text-white py-2 px-4 rounded-lg hover:bg-purple-600 transition-colors text-sm">Next Page</button>
                </div>
            </div>

            <div class="print-button-container text-center mt-8">
                <button onclick="window.print()" class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg text-sm transition-colors">Print Lesson</button>
            </div>
        </div>
    </main>

    <footer class="bg-slate-800 text-slate-300 py-6 mt-auto text-center">
        <div class="container mx-auto px-6">
            <p class="text-sm">&copy; <span id="currentYear"></span> RTApps. All Rights Reserved.</p>
            <p class="text-xs mt-1">Patient Identification & Safety Protocols Lesson</p>
        </div>
    </footer>

    <script>
        let currentLessonPage = 1;
        const totalLessonPages = 6; 
        const lessonPages = document.querySelectorAll('.lesson-page');
        const prevLessonButton = document.getElementById('prevLessonPage');
        const nextLessonButton = document.getElementById('nextLessonPage');
        const backToMenuButton = document.getElementById('backToMenuButton');
        const lessonPageIndicator = document.getElementById('lessonPageIndicator');
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        const lessonCorrectAnswers = {
            'q_page2_1': 'B',
            'q_page3_1': 'C',
            'q_page5_1': 'B' 
            // Add q_page4_1 if you add a question there
        };

        function displayLessonPage() {
            lessonPages.forEach((page, index) => {
                page.style.display = (index === currentLessonPage - 1) ? 'block' : 'none';
            });
            prevLessonButton.disabled = currentLessonPage === 1;
            if (currentLessonPage === totalLessonPages) {
                nextLessonButton.style.display = 'none';
                if (backToMenuButton) backToMenuButton.style.display = 'inline-block';
            } else {
                nextLessonButton.style.display = 'inline-block';
                if (backToMenuButton) backToMenuButton.style.display = 'none';
            }
            lessonPageIndicator.textContent = `Page ${currentLessonPage} of ${totalLessonPages}`;
        }

        function changeLessonPage(direction) {
            currentLessonPage += direction;
            displayLessonPage();
        }

        function goBackToPatientCareMenu() {
            window.location.href = 'index.html'; // Assumes Patient Care menu is index.html in current folder
        }

        function checkPageAnswer(questionBlockId, correctAnswerValue) {
            const questionBlock = document.getElementById(questionBlockId);
            if (!questionBlock) return;
            const selectedRadio = questionBlock.querySelector(`input[name="${questionBlockId}_ans"]:checked`);
            const explanationDiv = questionBlock.querySelector('.explanation-text');
            
            questionBlock.classList.remove('correct-answer-feedback', 'incorrect-answer-feedback');
            questionBlock.querySelectorAll('label').forEach(label => {
                label.classList.remove('font-semibold', 'text-green-700', 'text-red-700');
                const indicator = label.querySelector('.correct-indicator, .incorrect-indicator');
                if(indicator) indicator.remove();
            });
            if (explanationDiv) explanationDiv.style.display = 'none';

            if (selectedRadio) {
                const userAnswer = selectedRadio.value;
                const userSelectedLabel = selectedRadio.parentElement;
                if (userAnswer === correctAnswerValue) {
                    questionBlock.classList.add('correct-answer-feedback');
                    userSelectedLabel.classList.add('font-semibold', 'text-green-700');
                    const indicator = document.createElement('span');
                    indicator.className = 'correct-indicator';
                    userSelectedLabel.appendChild(indicator);
                } else {
                    questionBlock.classList.add('incorrect-answer-feedback');
                    userSelectedLabel.classList.add('font-semibold', 'text-red-700');
                    const indicator = document.createElement('span');
                    indicator.className = 'incorrect-indicator';
                    userSelectedLabel.appendChild(indicator);
                    const correctRadio = questionBlock.querySelector(`input[name="${questionBlockId}_ans"][value="${correctAnswerValue}"]`);
                    if (correctRadio && correctRadio.parentElement) {
                        correctRadio.parentElement.classList.add('font-semibold', 'text-green-700');
                        const correctIndicator = document.createElement('span');
                        correctIndicator.className = 'correct-indicator';
                        correctRadio.parentElement.appendChild(correctIndicator);
                    }
                }
            } else { 
                questionBlock.classList.add('incorrect-answer-feedback');
                const correctRadio = questionBlock.querySelector(`input[name="${questionBlockId}_ans"][value="${correctAnswerValue}"]`);
                if (correctRadio && correctRadio.parentElement) {
                    correctRadio.parentElement.classList.add('font-semibold', 'text-green-700');
                     const correctIndicator = document.createElement('span');
                     correctIndicator.className = 'correct-indicator';
                     correctRadio.parentElement.appendChild(correctIndicator);
                }
            }
            if (explanationDiv) explanationDiv.style.display = 'block';
        }
        
        displayLessonPage();
    </script>
</body>
</html>
